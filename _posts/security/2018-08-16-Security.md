---
layout: post
title: Security
date: 2018-08-16
tag: security
site: https://zhangkn.github.io
catalog: true
author: kunnan
subtitle: 安全保护
---





# 前言

- 加固保护方案

  - 数据加密：
    - 网络传输的加密使用二进制协议传输数据
    - 本地存储的加密
    - 静态字符串的加密

  - 反调试\ 注入检测、hook检测、越狱检测、签名检测

    * [iOS-private-api-checker](https://github.com/iOSobfuscation/iOS-private-api-checker)

  - 静态混淆：类名方法名、属性的混淆

  - 代码混淆

    - 核心代码使用swift、c\c++ 实现

      * [2.0 把函数名隐藏在结构体里,以函数指针成员的形式存储](https://kunnan.github.io/2018/07/01/iosre_anti/#20-%E6%8A%8A%E5%87%BD%E6%95%B0%E5%90%8D%E9%9A%90%E8%97%8F%E5%9C%A8%E7%BB%93%E6%9E%84%E4%BD%93%E9%87%8C%E4%BB%A5%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88%E6%88%90%E5%91%98%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%AD%98%E5%82%A8)

    - 将代码分块、扁平化、增加干扰代码

      *  [LLVM Obfuscator](https://github.com/HikariObfuscator/Hikari)

         * [用法](https://kunnan.github.io/2018/06/05/iosObfuscation/)

      ![image](https://wx4.sinaimg.cn/large/af39b376gy1fubjg3ciuyj20c002dglx.jpg)

   



# I 、**数据加密：静态字符串、本地存储及网络传输加密**



> * 对用户的敏感信息进行加密保存
>
>   * 不管是本地的数据还是网络中传输的数据，对敏感数据需要采用加密算法进行加密处理，而常用的加密算法有 AES，RSA、BASE64、MD5、RSA。
>
>     

 

> * 根据加密结果是否可以解密，算法分为可逆加密和不可逆加密
>
>   
>
>   
>
>   * 不可逆加密算法，一般用于数据校验
>
>     * MD5：  将数据运算变为另一固定长度值，用于数据校验，不可逆
>
>       
>
>   * 可逆加密，又可以根据密钥的对称性可以分为对称加密和非对称加密
>
>     
>
>     * other
>       * base64: 一种基于64个可打印字符表示二进制数据的方法，主要为了将二进制数据变成可见字符，以便传输，可以解密
>     * 非对称加密算法：存在一个公钥和一个私钥
>       * RSA： 速度比对称加密算法慢很多
>     * 对称加密算法：加密和解密使用同一密钥
>       * DES：对二进制数据进行加密；明文、密文、密钥的分组长度都是64位
>       * AES：高级加密标准，本质上是一种对称分组密码体制，用来代替DES



#### 1.1 本地存储加密

> * [本地存储的方式](https://kunnan.github.io/2018/08/12/Accounts3/#1%E6%9C%AC%E5%9C%B0%E6%95%B0%E6%8D%AE%E6%94%BB%E4%B8%8E%E9%98%B2)
>
>   * **NSUserDefault**: 一般用于存储小规模数据、业务逻辑弱的数据。
>
>   * **keychain**: 苹果提供的可逆存储，因为有着只要app不重装系统、可以同步iCloud的特性，一般用来对用户的标识符或者一些需要加密的小数据进行存储。
>
>   * **归档**：主要原理是对数据进行序列化、反序列化操作后，写入、读出数据。方便便捷易使用，缺点查询、更改数据耗时耗性能。
>
>   * **数据库**：主要的有三种sqlite3、core data、[realm](https://realm.io/cn/docs/swift/latest/#model)。
>
>   * 系统键盘缓存
>
>     - 我们
>
>     - 我们打字在使用系统键盘打字时时，会出现提示，键盘一般会缓存这些提示字符串，缓存在手机的“/private/var/mobile/Library/Keyboard/xx-dynamic-text.dat”文件中，攻击者可以提取出来，出现频率最高的往往是账户名和密码 
>
>     - 我们打字在使用系统键盘打字时时，会出现提示，键盘一般会缓存这些提示字符串，缓存在手机的“/private/var/mobile/Library/Keyboard/xx-dynamic-text.dat”文件中，攻击者可以提取出来，出现频率最高的往往是账户名和密码 
>
>     - 我们打字在使用系统键盘打字时时，会出现提示，键盘一般会缓存这些提示字符串，缓存在手机的“/private/var/mobile/Library/Keyboard/xx-dynamic-text.dat”文件中，攻击者可以提取出来，出现频率最高的往往是账户名和密码。
>
>     - 我们打字在使用系统键盘打字时时，会出现提示，键盘一般会缓存这些提示字符串，缓存在手机的“/private/var/mobile/Library/Keyboard/xx-dynamic-text.dat”文件中，攻击者可以提取出来，出现频率最高的往往是账户名和密码
>
>     - 我们打字在使用系统键盘打字时时，会出现提示，键盘一般会缓存这些提示字符串，缓存在手机的“/private/var/mobile/Library/Keyboard/xx-dynamic-text.dat”文件中，攻击者可以提取出来，出现频率最高的往往是账户名和密码
>
>     - 我们打字在使用系统键盘打字时时，会出现提示，键盘一般会缓存这些提示字符串，缓存在手机的“/private/var/mobile/Library/Keyboard/xx-dynamic-text.dat”文件中，攻击者可以提取出来，出现频率最高的往往是账户名和密码
>
>     - 我们打字在使用系统键盘打字时时，会出现提示，键盘一般会缓存这些提示字符串，缓存在手机的“/private/var/mobile/Library/Keyboard/xx-dynamic-text.dat”文件中，攻击者可以提取出来，出现频率最高的往往是账户名和密码。
>
>        
>
>     - 我们打字在使用系统键盘打字时时，会出现提示，键盘一般会缓存这些提示字符串，缓存在手机的“/private/var/mobile/Library/Keyboard/xx-dynamic-text.dat”文件中，攻击者可以提取出来，出现频率最高的往往是账户名和密码。
>
>        
>
>    
>
>    
>
>    







# See Also 

>* [iosre_anti](https://kunnan.github.io/2018/07/01/iosre_anti/)
>* [knpost](https://github.com/zhangkn/KNBin/blob/master/knpost) 
>
```
/Users/devzkn/bin//knpost Security 安全保护 -t security
> #原来""的参数，需要自己加上""
```

